# GRVT vs Paradex 对冲交易机器人

自动监控 GRVT 和 Paradex 两个平台的价格差异，执行套利交易的机器人。

## 功能特点

- 🔄 自动监控两个平台的价格差异
- 💰 发现套利机会时自动开仓
- 🎯 GRVT 使用限价单，Paradex 使用市价单
- 🔒 自动平仓：GRVT 限价平仓 → Paradex 市价平仓
- ⏱️ 每次交易后随机等待 3-5 分钟
- 📊 交易统计和成功率追踪

## 文件说明

- `grvt-paradex.py` - 主程序，对冲交易机器人
- `grvt_bot.py` - GRVT 交易接口和测试程序
- `grvt.py` - GRVT 交易核心类（需要自行创建）
- `paradex_trader.py` - Paradex 交易操作类

## 环境要求

```bash
Python 3.8+
playwright
```

## 安装依赖

```bash
pip install playwright
playwright install chromium
```

## 使用方法

### 1. 运行主程序

```bash
python grvt-paradex.py
```

### 2. 选择模式

程序启动后会显示三个模式：

```
1. 单次对冲交易（手动）
2. 自动监控并对冲
3. 仅查看价格差异
```

### 3. 配置参数

选择模式后，需要输入以下参数：

- **价差阈值**（默认 10 美元）：只有当两个平台价差超过此值时才交易
- **订单大小**（默认 0.002）：每次交易的数量
- **检查间隔**（默认 5 秒）：价格检查的时间间隔

## 交易流程

### 自动对冲流程

1. **监控价格** → 获取 GRVT 和 Paradex 的中间价
2. **判断机会** → 价差是否超过阈值
3. **开仓**
   - GRVT 限价开仓（做多/做空）
   - 等待 GRVT 订单成交
   - Paradex 市价开仓（反向）
4. **平仓**
   - GRVT 限价平仓
   - 等待 GRVT 平仓成交（最多 30 秒）
   - Paradex 市价平仓
5. **等待** → 随机等待 3-5 分钟
6. **循环** → 回到步骤 1

### 策略说明

- **GRVT 价格高于 Paradex**：GRVT 做空 + Paradex 做多
- **GRVT 价格低于 Paradex**：GRVT 做多 + Paradex 做空

## 配置说明

### 浏览器配置

在 `create_browser_context()` 函数中修改：

```python
workid = 44  # 工作 ID
proxy = "127.0.0.1:7890"  # 代理地址
user_data = r"D:\"  # 用户数据目录
path_to_extension = r"D:\"  # MetaMask 插件路径
```

### 交易参数

在 `HedgeTradingBot` 类中修改默认值：

```python
price_diff_threshold: float = 10.0  # 价差阈值
order_size: float = 0.002  # 订单大小
check_interval: int = 5  # 检查间隔（秒）
```

## 安全提示

⚠️ **重要提示**：

1. 本程序仅用于测试网环境
2. 请勿在主网使用未经充分测试的代码
3. 交易有风险，请谨慎使用
4. 建议先使用"仅查看价格差异"模式测试
5. 确保有足够的资金和合理的风险控制

## 示例输出

```
🤖 对冲交易机器人已启动
============================================================
  价差阈值: $10.00
  订单大小: 0.002
  检查间隔: 5秒
============================================================

[12:34:56] 获取价格信息...
  GRVT 价格:    $95,123.45
  Paradex 价格: $95,110.20
  价差:         +$13.25 (+0.014%)

💰 发现套利机会：GRVT价格高 $13.25

🔥🔥🔥 执行对冲策略：GRVT做空 + Paradex做多 🔥🔥🔥

[1/3] GRVT 限价开空...
✅ GRVT限价单已提交

[2/3] 等待GRVT订单成交...
✅ GRVT订单已成交（等待3秒）

[3/3] Paradex 市价开多...
✅ Paradex市价单已成交

🎊🎊🎊 对冲成功：GRVT空头 + Paradex多头 🎊🎊🎊

步骤 2: 关闭持仓
🔄🔄🔄 检查并关闭现有持仓 🔄🔄🔄

[1/3] 发现 1 个 GRVT 持仓，准备限价平仓...
✅ GRVT 限价平仓订单已提交

[2/3] 等待 GRVT 平仓订单成交...
✅ GRVT 平仓订单已成交（等待 5 秒）

[3/3] 发现 1 个 Paradex 持仓，准备市价平仓...
✅ Paradex 持仓已全部平仓

⏳ 随机等待 245 秒 (4.1 分钟) 后继续下一次交易...
```

## 故障排除

### 常见问题

1. **GRVT 订单超时未成交**
   - 程序会自动取消挂单
   - 检查价格是否合理

2. **Paradex 开仓失败**
   - 检查账户余额
   - 检查网络连接

3. **平仓超时**
   - 程序会自动尝试市价平仓
   - 手动检查持仓状态

## 统计信息

程序停止时会显示交易统计：

```
📊 交易统计
============================================================
  总交易次数: 10
  成功: 8
  失败: 2
  成功率: 80.0%
============================================================
```

## 开发说明

### 主要类

- `HedgeTradingBot` - 对冲交易机器人主类
- `GrvtTradingBot` - GRVT 交易操作类
- `ParadexTrader` - Paradex 交易操作类

### 主要方法

- `get_price_difference()` - 获取价格差异
- `execute_hedge_grvt_short_paradex_long()` - 执行 GRVT 做空策略
- `execute_hedge_grvt_long_paradex_short()` - 执行 GRVT 做多策略
- `close_existing_positions()` - 关闭所有持仓
- `start_monitoring()` - 启动自动监控

## 许可证

MIT License

## 免责声明

本软件仅供学习和研究使用。使用本软件进行交易的任何损失，作者不承担任何责任。请在使用前充分了解相关风险。
